(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47e4c482","chunk-71ba1b66"],{"06cb":function(t,e,a){"use strict";e.__esModule=!0;var n=a("a593"),s=r(n),o=a("c865");function r(t){return t&&t.__esModule?t:{default:t}}var i=[],l="@@clickoutsideContext",c=void 0,u=0;function d(t,e,a){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(a&&a.context&&n.target&&s.target)||t.contains(n.target)||t.contains(s.target)||t===n.target||a.context.popperElm&&(a.context.popperElm.contains(n.target)||a.context.popperElm.contains(s.target))||(e.expression&&t[l].methodName&&a.context[t[l].methodName]?a.context[t[l].methodName]():t[l].bindingFn&&t[l].bindingFn())}}!s.default.prototype.$isServer&&(0,o.on)(document,"mousedown",(function(t){return c=t})),!s.default.prototype.$isServer&&(0,o.on)(document,"mouseup",(function(t){i.forEach((function(e){return e[l].documentHandler(t,c)}))})),e.default={bind:function(t,e,a){i.push(t);var n=u++;t[l]={id:n,documentHandler:d(t,e,a),methodName:e.expression,bindingFn:e.value}},update:function(t,e,a){t[l].documentHandler=d(t,e,a),t[l].methodName=e.expression,t[l].bindingFn=e.value},unbind:function(t){for(var e=i.length,a=0;a<e;a++)if(i[a][l].id===t[l].id){i.splice(a,1);break}delete t[l]}}},"10d9":function(t,e,a){"use strict";a.r(e);var n,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"container-fluid",staticStyle:{"padding-left":"10px !important","padding-right":"10px !important","overflow-x":"hidden"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-4"},[a("inline-actions-table",{staticClass:"tk-table-padding",on:{preview:t.preview}})],1),a("div",{staticClass:"col-lg-8 tk-table-max-height"},[a("search-bar-with-avatar"),t.showPreview?a("div",{staticClass:"card-wrapper"},[a("div",{staticClass:"card tk-no-shadow tk-bg-color-bg tk-px-margin-bottom-px0",staticStyle:{width:"calc(100% - 20px)","margin-right":"20px"}},[a("div",{staticClass:"card-body"},[a("user-basic-info",{attrs:{data:t.previewData,inline:!0,toolTip:!0,showArchive:!1},on:{onEdit:function(e){t.showEditTeacher=!0,t.initUserBasic()},onArchive:t.onArchive,onDelete:t.onDelete,onDeleteArchive:t.onDeleteArchive,onActive:t.onActive}})],1)]),a("div",{staticClass:"tk-teacher-detail",staticStyle:{height:"calc(100vh - 8px - 204px)",overflow:"auto"}},[a("div",{staticClass:"card tk-no-shadow tk-border-color-gray-200 tk-px-margin-bottom-px20",staticStyle:{width:"calc(100% - 20px)","margin-right":"20px"}},[a("div",{staticClass:"card-header"},[a("div",{staticClass:"row align-items-center"},[t._m(0),t.isLoadingLessons?t._e():a("div",{staticClass:"col-4 text-right"},[t.editLesson?a("span",{staticClass:"btn btn-sm btn-neutral tk-font-color-main",on:{click:function(e){return e.preventDefault(),t.toggleEditLesson(e)}}},[t._v("Done")]):a("span",{staticClass:"btn btn-sm btn-neutral tk-font-color-main",on:{click:function(e){return e.preventDefault(),t.toggleEditLesson(e)}}},[t._v("Add / Delete")])])])]),a("div",{staticClass:"card-body tk-px-padding-top-px0",style:{minHeight:t.isLoadingLessons?"130px":"0px"}},[t.isLoadingLessons?a("card-loading"):t._l(t.lessons,(function(e,n){return[a("div",{key:n,staticStyle:{width:"100%","min-height":"120px"}},[a("div",{staticClass:"tk-layout-inline-block",staticStyle:{width:"calc(100% - 20px)",height:"auto","min-height":"100px"}},[a("teacher-lesson-item",{staticClass:"tk-layout-inline-block",class:{"tk-cursor-pointer":!t.editLesson},staticStyle:{width:"100%"},attrs:{data:e},on:{showLessonDetail:t.showLessonDetail}})],1),a("div",{staticClass:"tk-layout-inline-block tk-px-width-px20 tk-font-color-main text-lg"},[t.editLesson?a("i",{staticClass:"fas fa-trash tk-font-color-red",on:{click:function(a){return a.preventDefault(),t.deleteLesson(e)}}}):a("i",{staticClass:"fas fa-chevron-right"})])])]})),a("div",{staticClass:"tk-px-padding-px20 tk-px-padding-left-px0 tk-px-padding-right-px0 tk-px-padding-bottom-px0 tk-cursor-pointer",staticStyle:{display:"none"},attrs:{id:"addNewLesson"},on:{click:function(e){e.preventDefault(),t.showAddNewLesson=!0}}},[t._m(1),a("div",{staticClass:"tk-layout-inline-block tk-px-margin-left-px16 tk-font-weight-bold tk-font-color-main",staticStyle:{width:"calc(100% - 48px - 16px)"}},[t._v(" New Lesson ")])])],2)]),t._m(2)])]):a("div",{staticClass:"tk-text-center",staticStyle:{height:"calc(100vh - 80px)","line-height":"calc(100vh - 160px)"}},[a("img",{staticStyle:{width:"80%"},attrs:{src:"/img/icons/tk/img_teachers.png"}})])],1)])]),a("modal",{staticClass:"tk-popup-outer",attrs:{show:t.showCreateNewTeacher},on:{"update:show":function(e){t.showCreateNewTeacher=e}}},[a("template",{slot:"header"},[a("h5",{staticClass:"modal-title"},[t._v("New Instructor")])]),a("div",{staticClass:"tk-popup-content"},[a("form",{staticClass:"card-wrapper"},[a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Full Name")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.fullName,expression:"fullName"}],staticClass:"form-control tk-font-color-black1",attrs:{type:"text"},domProps:{value:t.fullName},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:function(e){e.target.composing||(t.fullName=e.target.value)}}})])])])]),a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Email")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control tk-font-color-black1",class:{"is-invalid":t.isInvalid},attrs:{type:"text"},domProps:{value:t.email},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},blur:function(e){return e.preventDefault(),t.validationEmail(e)},input:function(e){e.target.composing||(t.email=e.target.value)}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isInvalid,expression:"isInvalid"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[t._v(" The email is not correct. ")])])])]),a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Phone")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"form-control tk-font-color-black1",attrs:{type:"text"},domProps:{value:t.phone},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:function(e){e.target.composing||(t.phone=e.target.value)}}})])])])]),a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Url")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],staticClass:"form-control tk-font-color-black1",attrs:{type:"text"},domProps:{value:t.url},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:function(e){e.target.composing||(t.url=e.target.value)}}})])])])])])]),a("template",{slot:"footer"},[a("base-button",{staticClass:"tk-font-color-lightGray tk-border-none",attrs:{type:"secondary"},on:{click:function(e){e.preventDefault(),t.showCreateNewTeacher=!1}}},[t._v("Close")]),a("base-button",{staticClass:"tk-font-color-white tk-bg-color-main tk-border-none",attrs:{type:"primary"},on:{click:function(e){e.preventDefault(),t.showCreateNewTeacher=!1}}},[t._v("Create")])],1)],2),a("modal",{staticClass:"tk-popup-outer",staticStyle:{"z-index":"2020"},attrs:{show:t.showEditTeacher},on:{"update:show":function(e){t.showEditTeacher=e}}},[a("template",{slot:"header"},[a("h5",{staticClass:"modal-title"},[t._v("Edit Instructor")])]),a("div",{staticClass:"tk-popup-content"},[a("form",{staticClass:"card-wrapper"},[a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Full Name")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.fullName,expression:"fullName"}],staticClass:"form-control tk-font-color-black1",attrs:{type:"text"},domProps:{value:t.fullName},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:function(e){e.target.composing||(t.fullName=e.target.value)}}})])])])]),a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Email")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control tk-font-color-black1",class:{"is-invalid":t.isInvalid},attrs:{type:"text"},domProps:{value:t.email},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},blur:function(e){return e.preventDefault(),t.validationEmail(e)},input:function(e){e.target.composing||(t.email=e.target.value)}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isInvalid,expression:"isInvalid"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[t._v(" The email is not correct. ")])])])]),a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Phone")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"form-control tk-font-color-black1",attrs:{type:"text"},domProps:{value:t.phone},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:function(e){e.target.composing||(t.phone=e.target.value)}}})])])])]),a("span",[a("div",{staticClass:"form-group card-wrapper tk-px-margin-bottom-px0"},[a("label",{staticClass:"form-control-label"},[t._v("Url")]),a("div",{staticClass:"card tk-px-margin-bottom-px16"},[a("div",{staticClass:"has-label card-body tk-px-padding-px0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],staticClass:"form-control tk-font-color-black1",attrs:{type:"text"},domProps:{value:t.url},on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:function(e){e.target.composing||(t.url=e.target.value)}}})])])])])])]),a("template",{slot:"footer"},[a("base-button",{staticClass:"tk-font-color-lightGray tk-border-none",attrs:{type:"secondary"},on:{click:function(e){e.preventDefault(),t.showEditTeacher=!1}}},[t._v("Close")]),a("button-with-loading",{staticStyle:{margin:"0 0 0 1rem"},attrs:{text:"Update",type:"main",complete:t.isButtonLoadingComplete},on:{start:t.updateTeacher}})],1)],2),a("modal",{staticStyle:{"z-index":"2020"},attrs:{show:t.showDelete},on:{"update:show":function(e){t.showDelete=e}}},[a("template",{slot:"header"},[a("h5",{staticClass:"modal-title"},[t._v("Delete Instructor")])]),a("div",{staticClass:"tk-popup-content"},[t._v(" Do you want to delete the instructor "),a("strong",{staticClass:"tk-font-color-black1"},[t._v("["+t._s(t.fullName)+"]")]),t._v(" ? ")]),a("template",{slot:"footer"},[a("base-button",{staticClass:"tk-font-color-lightGray tk-border-none",attrs:{type:"secondary"},on:{click:function(e){e.preventDefault(),t.showDelete=!1}}},[t._v("Close")]),a("base-button",{staticClass:"tk-font-color-white tk-bg-color-red tk-border-none",attrs:{type:"primary"},on:{click:function(e){return e.preventDefault(),t.confirmDelete(e)}}},[t._v("Delete")])],1)],2),t.showEditLessonDetail?a("create-student",{attrs:{title:"Lessons",showContact:!1,showContactCard:!0,isEdit:!0,lessonData:t.lessonData,contactData:t.studedntBasicData,contactLabel:"Student"},on:{close:function(e){t.showEditLessonDetail=!1,t.studedntBasicData=null},update:function(e){t.initLessons(t.lessonData.teacherId),t.showEditLessonDetail=!1}}}):t._e(),t.showAddNewLesson?a("create-student",{attrs:{title:"Add Lessons",showContact:!1,showContactCard:!0,selectUser:!0,lessonData:t.lessonData,contactLabel:"Select student",footBtn:"Add"},on:{close:function(e){t.showAddNewLesson=!1},add:function(e){t.initLessons(t.lessonData.teacherId),t.showAddNewLesson=!1}}}):t._e()],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-8"},[a("h5",{staticClass:"h3 mb-0"},[a("i",{staticClass:"fas fa-calendar-alt tk-font-color-card5 tk-px-width-px24 tk-px-margin-right-px8",staticStyle:{"font-size":"1.2rem"}}),a("span",[t._v("Lesson")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"avatar rounded-circle tk-layout-inline-block tk-border-color-gray-300 tk-font-color-main tk-bg-color-white tk-text-center",staticStyle:{"line-height":"48px"}},[a("i",{staticClass:"fas fa-plus"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card tk-no-shadow tk-border-color-gray-200 tk-px-margin-bottom-px20",staticStyle:{width:"calc(100% - 20px)","margin-right":"20px"}},[a("div",{staticClass:"card-header"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-8"},[a("h5",{staticClass:"h3 mb-0"},[a("i",{staticClass:"fas fa-wallet tk-font-color-orange tk-px-width-px24 tk-px-margin-right-px8",staticStyle:{"font-size":"1.2rem"}}),a("span",[t._v("Payout")])])]),a("div",{staticClass:"col-4 text-right"},[a("span",{staticClass:"btn btn-sm btn-neutral tk-font-color-main"},[t._v("More")])])])]),a("div",{staticClass:"card-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-8"},[a("div",[a("span",{staticClass:"tk-font-color-lightGray tk-px-margin-right-px16"},[t._v("No131 | 05/24:")]),a("span",{staticClass:"tk-font-color-black2"},[t._v("Guitar Basic, 30min")])]),a("div",[a("span",{staticClass:"tk-font-color-lightGray tk-px-margin-right-px16"},[t._v("Auto payment:")]),a("span",{staticClass:"tk-font-color-black2 tk-px-margin-right-px16"},[t._v("Wellsfargo, checking, ****7832")]),a("span",{staticClass:"tk-font-color-main tk-font-underline tk-cursor-pointer"},[t._v("Edit")])])]),a("div",{staticClass:"col-md-4 text-right"},[a("div",{staticClass:"font-weight-bold tk-font-color-default tk-text-base tk-layout-inline-block text-xl"},[t._v(" $100.00 ")])])])])])}],r=(a("82a8"),a("2a39"),a("6a61"),a("9ad1")),i=a("2cb5"),l=(a("ca6c"),a("2984"),a("2c83")),c=a.n(l),u=(a("31d0"),a("60bf")),d=a.n(u),p=(a("cc43"),a("855f")),m=a.n(p),f=(a("567e"),a("2b3e")),h=a.n(f),v=(a("93fd"),a("60cf")),g=a.n(v),k=a("5e3a"),b=a("a125"),w=a("fdc1"),x=a("2b84"),y=a("f5ef"),C=a("a336"),D=a.n(C),L={components:(n={InlineActionsTable:function(){return a.e("chunk-2d0e9b82").then(a.bind(null,"8f75"))}},Object(i["a"])(n,g.a.name,g.a),Object(i["a"])(n,h.a.name,h.a),Object(i["a"])(n,m.a.name,m.a),Object(i["a"])(n,d.a.name,d.a),Object(i["a"])(n,c.a.name,c.a),Object(i["a"])(n,"UserBasicInfo",(function(){return a.e("chunk-2d228c26").then(a.bind(null,"db0b"))})),Object(i["a"])(n,"CreateStudent",(function(){return a.e("chunk-77fea936").then(a.bind(null,"a6a9"))})),Object(i["a"])(n,"TeacherLessonItem",(function(){return a.e("chunk-2d0cbb70").then(a.bind(null,"4b9e"))})),Object(i["a"])(n,"SearchBarWithAvatar",(function(){return a.e("chunk-2d0daed4").then(a.bind(null,"6e4c"))})),Object(i["a"])(n,"buttonWithLoading",(function(){return a.e("chunk-5d7fb187").then(a.bind(null,"6ea5"))})),Object(i["a"])(n,"CardLoading",(function(){return a.e("chunk-271c3a43").then(a.bind(null,"1190"))})),n),data:function(){return{showCreateNewTeacher:!1,showDelete:!1,showEditTeacher:!1,deleteActive:!1,fullName:"",phone:"",email:"",url:"",isInvalid:!1,showPreview:!1,previewData:{},lessonData:{},studedntBasicData:null,lessons:[],editLesson:!1,showEditLessonDetail:!1,showAddNewLesson:!1,isButtonLoadingComplete:!1,isLoadingLessons:!0,isLoadingPayouts:!0}},mounted:function(){var t=this;y["a"].$on("addLesson",(function(e){t.preview(e),t.showAddNewLesson=!0}))},methods:{updateTeacher:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,console.log("更新教师信息: ",a.previewData),console.log("name: ",a.fullName),console.log("email: ",a.email),console.log("phone: ",a.phone),console.log("website: ",a.url),e.next=8,k["a"].user.doc(a.previewData.userId).update({name:a.fullName,email:a.email,phone:a.phone,website:a.url}).then((function(){a.showEditTeacher=!1,a.isButtonLoadingComplete=!0,a.previewData.name=a.fullName,a.previewData.email=a.email,a.previewData.phone=a.phone,a.previewData.website=a.url,a.$notify({message:"Update Success!",type:"success"})})).catch((function(t){console.log(t),a.showEditTeacher=!1,a.$notify({message:"Update failed, try it again!",type:"error"})}));case 8:a.isButtonLoadingComplete=!1;case 9:case"end":return e.stop()}}),e)})))()},showLessonDetail:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e,n.editLesson){a.next=8;break}return n.showEditLessonDetail=!0,n.lessonData=t,a.next=6,b["a"].getUserInfoByUserId(t.studentId);case 6:s=a.sent,n.$tools.isNull(s)?n.studedntBasicData={name:"",email:"",phone:"",avatar:""}:n.studedntBasicData={name:s.name,email:s.email,phone:s.phone,userId:s.userId,avatar:w["a"].userAvatarPath(s.userId)};case 8:case"end":return a.stop()}}),a)})))()},deleteLesson:function(t){var e=this;e.$firebase.functions().httpsCallable("deleteLessonsAfterSpecificTimeBasedOnConfigId");console.log(t)},toggleEditLesson:function(){var t=this;t.editLesson=!t.editLesson,D()("#addNewLesson").slideToggle()},validationEmail:function(){var t=this;t.$tools.isNull(t.email)?t.isInvalid=!1:t.isInvalid=!t.$tools.isEmail(t.email)},preview:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("点击教师item: ",t),n=e,n.showPreview=!0,n.previewData=t,n.lessonData.teacherId=t.userId,console.log("lessonData: ",n.lessonData),n.isLoadingLessons=!0,n.initUserBasic(),a.next=10,n.initLessons(t.userId);case 10:setTimeout((function(){n.isLoadingLessons=!1}),1e3);case 11:case"end":return a.stop()}}),a)})))()},initLessons:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,x["a"].listNextLessonsByTeacher(t);case 2:e.lessons=a.sent,console.log("init lessons: ",e.lessons),y["a"].$emit("refreshTeacherLessonCount",{teacherId:t,count:e.lessons.length});case 5:case"end":return a.stop()}}),a)})))()},initUserBasic:function(){var t=this;t.fullName=t.previewData.name,t.email=t.previewData.email,t.phone=t.previewData.phone,t.url=t.previewData.website},onActive:function(){var t=this;t.previewData.active=!0,y["a"].$emit("onActive",t.previewData)},onDeleteArchive:function(){var t=this;t.deleteActive=!1,t.showDelete=!0},onDelete:function(){var t=this;t.deleteActive=!0,t.showDelete=!0},onArchive:function(){var t=this;t.previewData.active=!1,y["a"].$emit("onArchive",t.previewData)},confirmDelete:function(){var t=this;y["a"].$emit("confirmDelete",t.previewData),t.showDelete=!1,t.showPreview=!1}}},_=L,I=a("5d22"),N=Object(I["a"])(_,s,o,!1,null,null,null);e["default"]=N.exports},"2b84":function(t,e,a){"use strict";a("4914"),a("82a8"),a("2a39"),a("f39f"),a("96f8"),a("4021");var n=a("f923"),s=(a("6a61"),a("9ad1")),o=(a("e204"),a("948b"),a("fdc1")),r=a("9194"),i=a("5e3a"),l=a("fef9"),c=a("a125");e["a"]={listAllTeachers:function(){return new Promise(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,a){var s,r,i,u,d,p,m,f,h,v,g,k;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("开始获取所有的教师信息"),t.next=4,l["a"].studioInfo();case 4:return s=t.sent,console.log("获取到的studioinfo: ",s),r=s.id,t.next=9,c["a"].getTeachersByStudioId(r);case 9:for(i=t.sent,console.log("获取到的教师信息: ",i),u={},d=[],p=[],m=0;m<i.length;m++)f=i[m].userId,i[m]["avatar"]=o["a"].studioLogoPath(i[m].studioId),d.push(c["a"].getUserInfoByUserId(f)),p.push(c["a"].getStudentsByTeacherId(f)),u[f]=i[m];return t.next=17,Promise.all(d);case 17:return h=t.sent,console.log("获取用户详情: ",h),t.next=21,Promise.all(p);case 21:v=t.sent,console.log("获取学生详情: ",v),h.forEach((function(t){var e=t.userId,a=u[e];console.log("------",a),a.phone=t.phone,a.email=t.email,a.website=t.website,a.active=t.active,a.name=t.name,a.studentCount=0,a.students=[],u[e]=a})),v.forEach((function(t){t.forEach((function(t){var e=t.teacherId,a=u[e],s=a.students;void 0!==Object(n["a"])(s)&&null!==s||(s=[]),s.push(t),a.students=s,a.studentCount=a.students.length,u[e]=a}))})),console.log("所有的教师信息: ",u),g=[],t.t0=regeneratorRuntime.keys(u);case 28:if((t.t1=t.t0()).done){t.next=36;break}return k=t.t1.value,t.next=32,c["a"].getTeacherFutureLessonsCountByTeacherId(k);case 32:u[k].lessonsCount=t.sent,g.push(u[k]),t.next=28;break;case 36:console.log("最后的数据:",g),e(g),t.next=43;break;case 40:t.prev=40,t.t2=t["catch"](0),a(t.t2);case 43:case"end":return t.stop()}}),t,null,[[0,40]])})));return function(e,a){return t.apply(this,arguments)}}())},listNextLessonsByTeacher:function(t){return new Promise(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a,n){var s,i,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getStudentsByTeacherId(t);case 3:s=e.sent,console.log("该老师的所有学生：",s),i=[],l=0;case 7:if(!(l<s.length)){e.next=42;break}return e.next=10,c["a"].getStudentNextLesson(s[l].studentId,s[l].teacherId);case 10:if(u=e.sent,null===u){e.next=39;break}return console.log("next lesosn: ",u),e.next=15,c["a"].getInstrumentById(u.instrumentId);case 15:if(d=e.sent,p=u.lessonScheduleData,!r["a"].isNull(p)){e.next=19;break}return e.abrupt("continue",39);case 19:return console.log("instrument",d),e.t0=i,e.t1=u.id,e.next=24,c["a"].getUserName(u.studentId);case 24:e.t2=e.sent,e.t3=o["a"].userAvatarPath(u.studentId),e.t4=d.name,e.t5=d.minPictureUrl,e.t6=u.instrumentId,e.t7=u.lessonTypeData.name,e.t8=o["a"].formatPrice(u.lessonTypeData.price),e.t9=u.lessonTypeData.timeLength+"min",e.t10=o["a"].formatRepeatType(p.repeatType),e.t11=r["a"].formatWeekday(1e3*u.shouldDateTime)+". "+r["a"].formatHHMMAP(1e3*u.shouldDateTime),e.t12=u.studentId,e.t13=u.teacherId,e.t14=u,e.t15={id:e.t1,name:e.t2,avatar:e.t3,instrument:e.t4,icon:e.t5,instrumentId:e.t6,lessonTypeName:e.t7,price:e.t8,timeLength:e.t9,repeatType:e.t10,schedule:e.t11,studentId:e.t12,teacherId:e.t13,originData:e.t14},e.t0.push.call(e.t0,e.t15);case 39:l++,e.next=7;break;case 42:console.log("最后获取的 lesson 数据: ",i),a(i),e.next=49;break;case 46:e.prev=46,e.t16=e["catch"](0),n(e.t16);case 49:case"end":return e.stop()}}),e,null,[[0,46]])})));return function(t,a){return e.apply(this,arguments)}}())},addLessonType:function(t){return new Promise(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i["a"].lessonType.doc(t.id).set(t).then((function(){a(!0)}));case 3:e.next=9;break;case 5:e.prev=5,e.t0=e["catch"](0),console.log(e.t0),a(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a){return e.apply(this,arguments)}}())},updateLessonConfig:function(t){return new Promise(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i["a"].lessonScheduleConfigure.doc(t.id).update(t).then((function(){a(!0)}));case 3:e.next=9;break;case 5:e.prev=5,e.t0=e["catch"](0),console.log(e.t0),a(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a){return e.apply(this,arguments)}}())},listAllLessonsByTeacher:function(t,e){var a=new Date(e),n=new Date(e);a.setMonth(a.getMonth()-1),n.setMonth(n.setMonth()+1);var o=parseInt(new Date(a.getFullYear()+"/"+(a.getMonth()+1)+"/1").getTime()/1e3),l=parseInt(new Date(n.getFullYear()+"/"+(n.getMonth()+1)+"/"+r["a"].getDaysInMonth(end.getTime())).getTime()/1e3);return new Promise(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a,n){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{s=i["a"].lessonSchedule.where("teacherId","==",t).where("shouldDateTime",">=",o).where("shouldDateTime","<=",l).get(),r=[],s.empty||s.forEach((function(t){if(t.exists){var e=t.data();e.url="",r.push(e)}})),a(r)}catch(c){n(c)}case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},listAllEventsByTeacher:function(t,e){return new Promise(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{n=[],e(n)}catch(s){a(s)}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},listLessonsAndEventsByTeacher:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var s,o,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.listAllLessonsByTeacher(t,e);case 2:return s=n.sent,n.next=5,a.listAllEventsByTeacher(t,e);case 5:return o=n.sent,r=s.concat(o),n.abrupt("return",r);case 8:case"end":return n.stop()}}),n)})))()}}},4914:function(t,e,a){"use strict";var n=a("4292"),s=a("bc5d"),o=a("a308"),r=a("3079"),i=a("4326"),l=a("2730"),c=a("5c14"),u=a("698e"),d=a("b9d5"),p=a("9345"),m=a("b4f5"),f=p("isConcatSpreadable"),h=9007199254740991,v="Maximum allowed index exceeded",g=m>=51||!s((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),k=d("concat"),b=function(t){if(!r(t))return!1;var e=t[f];return void 0!==e?!!e:o(t)},w=!g||!k;n({target:"Array",proto:!0,forced:w},{concat:function(t){var e,a,n,s,o,r=i(this),d=u(r,0),p=0;for(e=-1,n=arguments.length;e<n;e++)if(o=-1===e?r:arguments[e],b(o)){if(s=l(o.length),p+s>h)throw TypeError(v);for(a=0;a<s;a++,p++)a in o&&c(d,p,o[a])}else{if(p>=h)throw TypeError(v);c(d,p++,o)}return d.length=p,d}})},f923:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("6b07"),a("cf2b"),a("08b3"),a("2a39"),a("f39f"),a("4021");function n(t){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}}}]);
//# sourceMappingURL=chunk-47e4c482.2ee62190.js.map