(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52250cf6","chunk-71ba1b66"],{"06cb":function(e,t,a){"use strict";t.__esModule=!0;var n=a("a593"),r=o(n),s=a("c865");function o(e){return e&&e.__esModule?e:{default:e}}var i=[],l="@@clickoutsideContext",c=void 0,u=0;function d(e,t,a){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(a&&a.context&&n.target&&r.target)||e.contains(n.target)||e.contains(r.target)||e===n.target||a.context.popperElm&&(a.context.popperElm.contains(n.target)||a.context.popperElm.contains(r.target))||(t.expression&&e[l].methodName&&a.context[e[l].methodName]?a.context[e[l].methodName]():e[l].bindingFn&&e[l].bindingFn())}}!r.default.prototype.$isServer&&(0,s.on)(document,"mousedown",(function(e){return c=e})),!r.default.prototype.$isServer&&(0,s.on)(document,"mouseup",(function(e){i.forEach((function(t){return t[l].documentHandler(e,c)}))})),t.default={bind:function(e,t,a){i.push(e);var n=u++;e[l]={id:n,documentHandler:d(e,t,a),methodName:t.expression,bindingFn:t.value}},update:function(e,t,a){e[l].documentHandler=d(e,t,a),e[l].methodName=t.expression,e[l].bindingFn=t.value},unbind:function(e){for(var t=i.length,a=0;a<t;a++)if(i[a][l].id===e[l].id){i.splice(a,1);break}delete e[l]}}},"2b84":function(e,t,a){"use strict";a("4914"),a("82a8"),a("2a39"),a("f39f"),a("96f8"),a("4021");var n=a("f923"),r=(a("6a61"),a("9ad1")),s=(a("e204"),a("948b"),a("fdc1")),o=a("9194"),i=a("5e3a"),l=a("fef9"),c=a("a125");t["a"]={listAllTeachers:function(){return new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var r,o,i,u,d,m,f,h,p,g,v,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("开始获取所有的教师信息"),e.next=4,l["a"].studioInfo();case 4:return r=e.sent,console.log("获取到的studioinfo: ",r),o=r.id,e.next=9,c["a"].getTeachersByStudioId(o);case 9:for(i=e.sent,console.log("获取到的教师信息: ",i),u={},d=[],m=[],f=0;f<i.length;f++)h=i[f].userId,i[f]["avatar"]=s["a"].studioLogoPath(i[f].studioId),d.push(c["a"].getUserInfoByUserId(h)),m.push(c["a"].getStudentsByTeacherId(h)),u[h]=i[f];return e.next=17,Promise.all(d);case 17:return p=e.sent,console.log("获取用户详情: ",p),e.next=21,Promise.all(m);case 21:g=e.sent,console.log("获取学生详情: ",g),p.forEach((function(e){var t=e.userId,a=u[t];console.log("------",a),a.phone=e.phone,a.email=e.email,a.website=e.website,a.active=e.active,a.name=e.name,a.studentCount=0,a.students=[],u[t]=a})),g.forEach((function(e){e.forEach((function(e){var t=e.teacherId,a=u[t],r=a.students;void 0!==Object(n["a"])(r)&&null!==r||(r=[]),r.push(e),a.students=r,a.studentCount=a.students.length,u[t]=a}))})),console.log("所有的教师信息: ",u),v=[],e.t0=regeneratorRuntime.keys(u);case 28:if((e.t1=e.t0()).done){e.next=36;break}return b=e.t1.value,e.next=32,c["a"].getTeacherFutureLessonsCountByTeacherId(b);case 32:u[b].lessonsCount=e.sent,v.push(u[b]),e.next=28;break;case 36:console.log("最后的数据:",v),t(v),e.next=43;break;case 40:e.prev=40,e.t2=e["catch"](0),a(e.t2);case 43:case"end":return e.stop()}}),e,null,[[0,40]])})));return function(t,a){return e.apply(this,arguments)}}())},listNextLessonsByTeacher:function(e){return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a,n){var r,i,l,u,d,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c["a"].getStudentsByTeacherId(e);case 3:r=t.sent,console.log("该老师的所有学生：",r),i=[],l=0;case 7:if(!(l<r.length)){t.next=42;break}return t.next=10,c["a"].getStudentNextLesson(r[l].studentId,r[l].teacherId);case 10:if(u=t.sent,null===u){t.next=39;break}return console.log("next lesosn: ",u),t.next=15,c["a"].getInstrumentById(u.instrumentId);case 15:if(d=t.sent,m=u.lessonScheduleData,!o["a"].isNull(m)){t.next=19;break}return t.abrupt("continue",39);case 19:return console.log("instrument",d),t.t0=i,t.t1=u.id,t.next=24,c["a"].getUserName(u.studentId);case 24:t.t2=t.sent,t.t3=s["a"].userAvatarPath(u.studentId),t.t4=d.name,t.t5=d.minPictureUrl,t.t6=u.instrumentId,t.t7=u.lessonTypeData.name,t.t8=s["a"].formatPrice(u.lessonTypeData.price),t.t9=u.lessonTypeData.timeLength+"min",t.t10=s["a"].formatRepeatType(m.repeatType),t.t11=o["a"].formatWeekday(1e3*u.shouldDateTime)+". "+o["a"].formatHHMMAP(1e3*u.shouldDateTime),t.t12=u.studentId,t.t13=u.teacherId,t.t14=u,t.t15={id:t.t1,name:t.t2,avatar:t.t3,instrument:t.t4,icon:t.t5,instrumentId:t.t6,lessonTypeName:t.t7,price:t.t8,timeLength:t.t9,repeatType:t.t10,schedule:t.t11,studentId:t.t12,teacherId:t.t13,originData:t.t14},t.t0.push.call(t.t0,t.t15);case 39:l++,t.next=7;break;case 42:console.log("最后获取的 lesson 数据: ",i),a(i),t.next=49;break;case 46:t.prev=46,t.t16=t["catch"](0),n(t.t16);case 49:case"end":return t.stop()}}),t,null,[[0,46]])})));return function(e,a){return t.apply(this,arguments)}}())},addLessonType:function(e){return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].lessonType.doc(e.id).set(e).then((function(){a(!0)}));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0),a(!1);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,a){return t.apply(this,arguments)}}())},updateLessonConfig:function(e){return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].lessonScheduleConfigure.doc(e.id).update(e).then((function(){a(!0)}));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0),a(!1);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,a){return t.apply(this,arguments)}}())},listAllLessonsByTeacher:function(e,t){var a=o["a"].isNull(t)?new Date:new Date(t),n=o["a"].isNull(t)?new Date:new Date(t);a.setMonth(a.getMonth()-1),n.setMonth(n.getMonth()+1);var l=parseInt(new Date(a.getFullYear()+"/"+(a.getMonth()+1)+"/1").getTime()/1e3),c=parseInt(new Date(n.getFullYear()+"/"+(n.getMonth()+1)+"/"+o["a"].getDaysInMonth(n.getTime())).getTime()/1e3);return console.log(l,c),new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].lessonSchedule.where("teacherId","==",e).where("shouldDateTime",">=",l).where("shouldDateTime","<=",c).get();case 3:r=t.sent,o=[],r.empty||r.forEach((function(e){if(e.exists){var t=e.data();t.url=s["a"].userAvatarPath(t.studentId),t.isOverDay=!1,t.type=1,t.name=t.lessonTypeData.name,t.shouldDateTime=1e3*t.shouldDateTime,o.push(t)}})),a(o),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,a){return t.apply(this,arguments)}}())},listAllEventsByTeacher:function(e,t){return new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{n=[],t(n)}catch(r){a(r)}case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},listLessonsAndEventsByTeacherId:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r,s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.listAllLessonsByTeacher(e,t);case 2:return r=n.sent,n.next=5,a.listAllEventsByTeacher(e,t);case 5:return s=n.sent,o=r.concat(s),n.abrupt("return",o);case 8:case"end":return n.stop()}}),n)})))()}}},4914:function(e,t,a){"use strict";var n=a("4292"),r=a("bc5d"),s=a("a308"),o=a("3079"),i=a("4326"),l=a("2730"),c=a("5c14"),u=a("698e"),d=a("b9d5"),m=a("9345"),f=a("b4f5"),h=m("isConcatSpreadable"),p=9007199254740991,g="Maximum allowed index exceeded",v=f>=51||!r((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),b=d("concat"),w=function(e){if(!o(e))return!1;var t=e[h];return void 0!==t?!!t:s(e)},y=!v||!b;n({target:"Array",proto:!0,forced:y},{concat:function(e){var t,a,n,r,s,o=i(this),d=u(o,0),m=0;for(t=-1,n=arguments.length;t<n;t++)if(s=-1===t?o:arguments[t],w(s)){if(r=l(s.length),m+r>p)throw TypeError(g);for(a=0;a<r;a++,m++)a in s&&c(d,m,s[a])}else{if(m>=p)throw TypeError(g);c(d,m++,s)}return d.length=m,d}})},de8b:function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"card"},[e._m(0),a("el-table",{staticClass:"table-responsive align-items-center table-flush",attrs:{"header-row-class-name":"thead-light",data:e.users}},[a("el-table-column",{attrs:{label:"Name","min-width":"200px",prop:"name",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("img",{staticClass:"avatar rounded-circle mr-3",attrs:{src:n.image}}),a("router-link",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{to:{name:"studentDetail"}}},[a("b",[e._v(e._s(n.name))])])]}}])}),a("el-table-column",{attrs:{label:"Created At",prop:"createdAt","min-width":"160px",sortable:""}}),a("el-table-column",{attrs:{label:"Instrument","min-width":"130px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(n.lesson))])]}}])}),a("el-table-column",{attrs:{label:"Lesson Type","min-width":"160px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(n.lessonType))])]}}])}),a("el-table-column",{attrs:{"min-width":"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return a("div",{staticClass:"table-actions"},[a("el-tooltip",{attrs:{content:"Edit",placement:"top"}},[a("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Edit"},on:{click:function(t){return t.preventDefault(),e.onEdit(n)}}},[a("i",{staticClass:"fas fa-user-edit"})])]),a("el-tooltip",{attrs:{content:"Archive",placement:"top"}},[a("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Archive"},on:{click:function(t){return t.preventDefault(),e.onArchive(n)}}},[a("i",{staticClass:"fas fa-inbox"})])]),a("el-tooltip",{attrs:{content:"Delete",placement:"top"}},[a("a",{staticClass:"table-action table-action-delete",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Delete"},on:{click:function(t){return t.preventDefault(),e.onDelete(n)}}},[a("i",{staticClass:"fas fa-trash"})])])],1)}}])})],1),e.users.length>0?a("div",{staticClass:"card-footer py-4 d-flex justify-content-end"},[a("base-pagination",{attrs:{total:50},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1):e._e()],1),e.archive.length>0?a("div",{staticClass:"card"},[e._m(1),a("el-table",{staticClass:"table-responsive align-items-center table-flush",attrs:{"header-row-class-name":"thead-light",data:e.archive}},[a("el-table-column",{attrs:{label:"Name","min-width":"200px",prop:"name",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("img",{staticClass:"avatar rounded-circle mr-3",attrs:{src:n.image}}),a("router-link",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{to:{name:"studentDetail"}}},[a("b",[e._v(e._s(n.name))])])]}}],null,!1,1944841434)}),a("el-table-column",{attrs:{label:"Created At",prop:"createdAt","min-width":"160px",sortable:""}}),a("el-table-column",{attrs:{label:"Lesson","min-width":"130px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(n.lesson))])]}}],null,!1,3930942327)}),a("el-table-column",{attrs:{label:"Lesson Type","min-width":"160px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(n.lessonType))])]}}],null,!1,3088631247)}),a("el-table-column",{attrs:{"min-width":"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return a("div",{staticClass:"table-actions"},[a("el-tooltip",{attrs:{content:"Edit",placement:"top"}},[a("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Edit"},on:{click:function(t){return t.preventDefault(),e.onEdit(n)}}},[a("i",{staticClass:"fas fa-user-edit"})])]),a("el-tooltip",{attrs:{content:"Archive",placement:"top"}},[a("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Archive"},on:{click:function(t){return t.preventDefault(),e.onActive(n)}}},[a("i",{staticClass:"fas fa-undo-alt"})])]),a("el-tooltip",{attrs:{content:"Delete",placement:"top"}},[a("a",{staticClass:"table-action table-action-delete",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Delete"},on:{click:function(t){return t.preventDefault(),e.onDeleteArchive(n)}}},[a("i",{staticClass:"fas fa-trash"})])])],1)}}],null,!1,3319439054)})],1),e.archive.length>0?a("div",{staticClass:"card-footer py-4 d-flex justify-content-end"},[a("base-pagination",{attrs:{total:50},model:{value:e.currentPage2,callback:function(t){e.currentPage2=t},expression:"currentPage2"}})],1):e._e()],1):e._e(),e.showCreate?a("create-student",{attrs:{title:"Edit Student",name:e.fullName,isEdit:!0},on:{close:function(t){e.showCreate=!1},update:function(t){e.showCreate=!1}}}):e._e(),a("modal",{attrs:{show:e.showDelete},on:{"update:show":function(t){e.showDelete=t}}},[a("template",{slot:"header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[e._v(" Delete Student ")])]),a("div",{staticClass:"tk-popup-content"},[e._v(" Do you want to delete the student "),e.index>=0?a("strong",{staticClass:"tk-font-color-black1"},[e._v("["+e._s(e.users[e.index].name)+"]")]):e._e(),e._v(" ? ")]),a("template",{slot:"footer"},[a("base-button",{staticClass:"tk-font-color-lightGray tk-border-none",attrs:{type:"secondary"},on:{click:function(t){t.preventDefault(),e.showDelete=!1}}},[e._v("Close")]),a("base-button",{staticClass:"tk-font-color-white tk-bg-color-red tk-border-none",attrs:{type:"primary"},on:{click:function(t){return t.preventDefault(),e.confirmDelete(t)}}},[e._v("Delete")])],1)],2)],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-header border-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("h3",{staticClass:"mb-0"},[e._v("Student List")])])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-header border-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("h3",{staticClass:"mb-0"},[e._v("Archive Students")])])])])}],o=(a("9010"),a("82a8"),a("2cb5")),i=(a("cc43"),a("2984"),a("855f")),l=a.n(i),c=(a("567e"),a("2b3e")),u=a.n(c),d=(a("93fd"),a("60cf")),m=a.n(d),f=(a("ca6c"),a("2c83")),h=a.n(f),p=(a("31d0"),a("60bf")),g=a.n(p),v=(a("4f55"),a("c944")),b=a.n(v),w=[{id:2,name:"Alexandra Smith",image:"img/theme/team-2.jpg",createdAt:"08/09/2018",lesson:"Piano",lessonType:"Standard Listening",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:3,name:"Samantha Ivy",image:"/img/theme/team-3.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:4,name:"Samantha Ivy",image:"/img/theme/team-4.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:5,name:"Alexandra Smith",image:"img/theme/team-2.jpg",createdAt:"08/09/2018",lesson:"Piano",lessonType:"Standard Listening",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:6,name:"Samantha Ivy",image:"/img/theme/team-3.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:7,name:"Samantha Ivy",image:"/img/theme/team-4.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1}],y=[],x=a("a6a9"),k={name:"inline-actions-table",components:(n={},Object(o["a"])(n,b.a.name,b.a),Object(o["a"])(n,g.a.name,g.a),Object(o["a"])(n,h.a.name,h.a),Object(o["a"])(n,m.a.name,m.a),Object(o["a"])(n,u.a.name,u.a),Object(o["a"])(n,l.a.name,l.a),Object(o["a"])(n,"CreateStudent",x["default"]),n),data:function(){return{users:w,archive:y,currentPage:1,currentPage2:1,showDelete:!1,showEditTeacher:!1,isInvalid:!1,deleteArchive:!1,showCreate:!1,fullName:"",phone:"",email:"",index:-1}},methods:{onEdit:function(e){var t=this;t.fullName=e.name,t.phone=e.phone,t.email=e.email,t.showCreate=!0},onDelete:function(e){var t=this;t.users.some((function(a,n){a.id===e.id&&(t.index=n,t.showDelete=!0)}))},onDeleteArchive:function(e){var t=this;t.archive.some((function(a,n){a.id===e.id&&(t.index=n,t.showDelete=!0,t.deleteArchive=!0)}))},confirmDelete:function(){var e=this;e.showDelete=!1,e.deleteArchive?(e.archive.splice(e.index,1),e.deleteArchive=!1):e.users.splice(e.index,1),e.index=-1},onArchive:function(e){var t=this;t.users.some((function(a,n){a.id===e.id&&(t.archive.push(a),t.users.splice(n,1))}))},onActive:function(e){var t=this;t.archive.some((function(a,n){a.id===e.id&&(t.users.push(a),t.archive.splice(n,1))}))},validationEmail:function(){var e=this;e.$tools.isNull(e.email)?e.isInvalid=!1:e.isInvalid=!e.$tools.isEmail(e.email)}}},C=k,D=a("5d22"),T=Object(D["a"])(C,r,s,!1,null,null,null);t["default"]=T.exports},f923:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("6b07"),a("cf2b"),a("08b3"),a("2a39"),a("f39f"),a("4021");function n(e){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}}}]);
//# sourceMappingURL=chunk-52250cf6.92cecbe9.js.map