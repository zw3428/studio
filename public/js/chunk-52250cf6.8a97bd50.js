(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52250cf6","chunk-71ba1b66"],{"06cb":function(e,t,n){"use strict";t.__esModule=!0;var a=n("a593"),r=o(a),s=n("c865");function o(e){return e&&e.__esModule?e:{default:e}}var i=[],l="@@clickoutsideContext",c=void 0,u=0;function d(e,t,n){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(n&&n.context&&a.target&&r.target)||e.contains(a.target)||e.contains(r.target)||e===a.target||n.context.popperElm&&(n.context.popperElm.contains(a.target)||n.context.popperElm.contains(r.target))||(t.expression&&e[l].methodName&&n.context[e[l].methodName]?n.context[e[l].methodName]():e[l].bindingFn&&e[l].bindingFn())}}!r.default.prototype.$isServer&&(0,s.on)(document,"mousedown",(function(e){return c=e})),!r.default.prototype.$isServer&&(0,s.on)(document,"mouseup",(function(e){i.forEach((function(t){return t[l].documentHandler(e,c)}))})),t.default={bind:function(e,t,n){i.push(e);var a=u++;e[l]={id:a,documentHandler:d(e,t,n),methodName:t.expression,bindingFn:t.value}},update:function(e,t,n){e[l].documentHandler=d(e,t,n),e[l].methodName=t.expression,e[l].bindingFn=t.value},unbind:function(e){for(var t=i.length,n=0;n<t;n++)if(i[n][l].id===e[l].id){i.splice(n,1);break}delete e[l]}}},"2b84":function(e,t,n){"use strict";n("4914"),n("82a8"),n("2a39"),n("f39f"),n("96f8"),n("4021");var a=n("f923"),r=(n("6a61"),n("9ad1")),s=(n("e204"),n("948b"),n("fdc1")),o=n("9194"),i=n("5e3a"),l=n("fef9"),c=n("a125");t["a"]={listAllTeachers:function(){return new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,i,u,d,m,f,h,p,g,v,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("开始获取所有的教师信息"),e.next=4,l["a"].studioInfo();case 4:return r=e.sent,console.log("获取到的studioinfo: ",r),o=r.id,e.next=9,c["a"].getTeachersByStudioId(o);case 9:for(i=e.sent,console.log("获取到的教师信息: ",i),u={},d=[],m=[],f=0;f<i.length;f++)h=i[f].userId,i[f]["avatar"]=s["a"].studioLogoPath(i[f].studioId),d.push(c["a"].getUserInfoByUserId(h)),m.push(c["a"].getStudentsByTeacherId(h)),u[h]=i[f];return e.next=17,Promise.all(d);case 17:return p=e.sent,console.log("获取用户详情: ",p),e.next=21,Promise.all(m);case 21:g=e.sent,console.log("获取学生详情: ",g),p.forEach((function(e){var t=e.userId,n=u[t];console.log("------",n),n.phone=e.phone,n.email=e.email,n.website=e.website,n.active=e.active,n.name=e.name,n.studentCount=0,n.students=[],u[t]=n})),g.forEach((function(e){e.forEach((function(e){var t=e.teacherId,n=u[t],r=n.students;void 0!==Object(a["a"])(r)&&null!==r||(r=[]),r.push(e),n.students=r,n.studentCount=n.students.length,u[t]=n}))})),console.log("所有的教师信息: ",u),v=[],e.t0=regeneratorRuntime.keys(u);case 28:if((e.t1=e.t0()).done){e.next=36;break}return b=e.t1.value,e.next=32,c["a"].getTeacherFutureLessonsCountByTeacherId(b);case 32:u[b].lessonsCount=e.sent,v.push(u[b]),e.next=28;break;case 36:console.log("最后的数据:",v),t(v),e.next=43;break;case 40:e.prev=40,e.t2=e["catch"](0),n(e.t2);case 43:case"end":return e.stop()}}),e,null,[[0,40]])})));return function(t,n){return e.apply(this,arguments)}}())},listNextLessonsByTeacher:function(e){return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,a){var r,i,l,u,d,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c["a"].getStudentsByTeacherId(e);case 3:r=t.sent,console.log("该老师的所有学生：",r),i=[],l=0;case 7:if(!(l<r.length)){t.next=42;break}return t.next=10,c["a"].getStudentNextLesson(r[l].studentId,r[l].teacherId);case 10:if(u=t.sent,null===u){t.next=39;break}return console.log("next lesosn: ",u),t.next=15,c["a"].getInstrumentById(u.instrumentId);case 15:if(d=t.sent,m=u.lessonScheduleData,!o["a"].isNull(m)){t.next=19;break}return t.abrupt("continue",39);case 19:return console.log("instrument",d),t.t0=i,t.t1=u.id,t.next=24,c["a"].getUserName(u.studentId);case 24:t.t2=t.sent,t.t3=s["a"].userAvatarPath(u.studentId),t.t4=d.name,t.t5=d.minPictureUrl,t.t6=u.instrumentId,t.t7=u.lessonTypeData.name,t.t8=s["a"].formatPrice(u.lessonTypeData.price),t.t9=u.lessonTypeData.timeLength+"min",t.t10=s["a"].formatRepeatType(m.repeatType),t.t11=o["a"].formatWeekday(1e3*u.shouldDateTime)+". "+o["a"].formatHHMMAP(1e3*u.shouldDateTime),t.t12=u.studentId,t.t13=u.teacherId,t.t14=u,t.t15={id:t.t1,name:t.t2,avatar:t.t3,instrument:t.t4,icon:t.t5,instrumentId:t.t6,lessonTypeName:t.t7,price:t.t8,timeLength:t.t9,repeatType:t.t10,schedule:t.t11,studentId:t.t12,teacherId:t.t13,originData:t.t14},t.t0.push.call(t.t0,t.t15);case 39:l++,t.next=7;break;case 42:console.log("最后获取的 lesson 数据: ",i),n(i),t.next=49;break;case 46:t.prev=46,t.t16=t["catch"](0),a(t.t16);case 49:case"end":return t.stop()}}),t,null,[[0,46]])})));return function(e,n){return t.apply(this,arguments)}}())},addLessonType:function(e){return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].lessonType.doc(e.id).set(e).then((function(){n(!0)}));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0),n(!1);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,n){return t.apply(this,arguments)}}())},updateLessonConfig:function(e){return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].lessonScheduleConfigure.doc(e.id).update(e).then((function(){n(!0)}));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0),n(!1);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,n){return t.apply(this,arguments)}}())},listAllLessonsByTeacher:function(e,t){var n=new Date(t),a=new Date(t);n.setMonth(n.getMonth()-1),a.setMonth(a.setMonth()+1);var s=parseInt(new Date(n.getFullYear()+"/"+(n.getMonth()+1)+"/1").getTime()/1e3),l=parseInt(new Date(a.getFullYear()+"/"+(a.getMonth()+1)+"/"+o["a"].getDaysInMonth(end.getTime())).getTime()/1e3);return new Promise(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,a){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{r=i["a"].lessonSchedule.where("teacherId","==",e).where("shouldDateTime",">=",s).where("shouldDateTime","<=",l).get(),o=[],r.empty||r.forEach((function(e){if(e.exists){var t=e.data();t.url="",o.push(t)}})),n(o)}catch(c){a(c)}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},listAllEventsByTeacher:function(e,t){return new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{a=[],t(a)}catch(r){n(r)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},listLessonsAndEventsByTeacher:function(e,t){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var r,s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.listAllLessonsByTeacher(e,t);case 2:return r=a.sent,a.next=5,n.listAllEventsByTeacher(e,t);case 5:return s=a.sent,o=r.concat(s),a.abrupt("return",o);case 8:case"end":return a.stop()}}),a)})))()}}},4914:function(e,t,n){"use strict";var a=n("4292"),r=n("bc5d"),s=n("a308"),o=n("3079"),i=n("4326"),l=n("2730"),c=n("5c14"),u=n("698e"),d=n("b9d5"),m=n("9345"),f=n("b4f5"),h=m("isConcatSpreadable"),p=9007199254740991,g="Maximum allowed index exceeded",v=f>=51||!r((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),b=d("concat"),w=function(e){if(!o(e))return!1;var t=e[h];return void 0!==t?!!t:s(e)},y=!v||!b;a({target:"Array",proto:!0,forced:y},{concat:function(e){var t,n,a,r,s,o=i(this),d=u(o,0),m=0;for(t=-1,a=arguments.length;t<a;t++)if(s=-1===t?o:arguments[t],w(s)){if(r=l(s.length),m+r>p)throw TypeError(g);for(n=0;n<r;n++,m++)n in s&&c(d,m,s[n])}else{if(m>=p)throw TypeError(g);c(d,m++,s)}return d.length=m,d}})},de8b:function(e,t,n){"use strict";n.r(t);var a,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"card"},[e._m(0),n("el-table",{staticClass:"table-responsive align-items-center table-flush",attrs:{"header-row-class-name":"thead-light",data:e.users}},[n("el-table-column",{attrs:{label:"Name","min-width":"200px",prop:"name",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("img",{staticClass:"avatar rounded-circle mr-3",attrs:{src:a.image}}),n("router-link",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{to:{name:"studentDetail"}}},[n("b",[e._v(e._s(a.name))])])]}}])}),n("el-table-column",{attrs:{label:"Created At",prop:"createdAt","min-width":"160px",sortable:""}}),n("el-table-column",{attrs:{label:"Instrument","min-width":"130px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(a.lesson))])]}}])}),n("el-table-column",{attrs:{label:"Lesson Type","min-width":"160px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(a.lessonType))])]}}])}),n("el-table-column",{attrs:{"min-width":"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return n("div",{staticClass:"table-actions"},[n("el-tooltip",{attrs:{content:"Edit",placement:"top"}},[n("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Edit"},on:{click:function(t){return t.preventDefault(),e.onEdit(a)}}},[n("i",{staticClass:"fas fa-user-edit"})])]),n("el-tooltip",{attrs:{content:"Archive",placement:"top"}},[n("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Archive"},on:{click:function(t){return t.preventDefault(),e.onArchive(a)}}},[n("i",{staticClass:"fas fa-inbox"})])]),n("el-tooltip",{attrs:{content:"Delete",placement:"top"}},[n("a",{staticClass:"table-action table-action-delete",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Delete"},on:{click:function(t){return t.preventDefault(),e.onDelete(a)}}},[n("i",{staticClass:"fas fa-trash"})])])],1)}}])})],1),e.users.length>0?n("div",{staticClass:"card-footer py-4 d-flex justify-content-end"},[n("base-pagination",{attrs:{total:50},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1):e._e()],1),e.archive.length>0?n("div",{staticClass:"card"},[e._m(1),n("el-table",{staticClass:"table-responsive align-items-center table-flush",attrs:{"header-row-class-name":"thead-light",data:e.archive}},[n("el-table-column",{attrs:{label:"Name","min-width":"200px",prop:"name",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("img",{staticClass:"avatar rounded-circle mr-3",attrs:{src:a.image}}),n("router-link",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{to:{name:"studentDetail"}}},[n("b",[e._v(e._s(a.name))])])]}}],null,!1,1944841434)}),n("el-table-column",{attrs:{label:"Created At",prop:"createdAt","min-width":"160px",sortable:""}}),n("el-table-column",{attrs:{label:"Lesson","min-width":"130px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(a.lesson))])]}}],null,!1,3930942327)}),n("el-table-column",{attrs:{label:"Lesson Type","min-width":"160px",prop:"lesson",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("a",{staticClass:"font-weight-bold  tk-font-color-default",attrs:{href:"#!"}},[e._v(e._s(a.lessonType))])]}}],null,!1,3088631247)}),n("el-table-column",{attrs:{"min-width":"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return n("div",{staticClass:"table-actions"},[n("el-tooltip",{attrs:{content:"Edit",placement:"top"}},[n("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Edit"},on:{click:function(t){return t.preventDefault(),e.onEdit(a)}}},[n("i",{staticClass:"fas fa-user-edit"})])]),n("el-tooltip",{attrs:{content:"Archive",placement:"top"}},[n("a",{staticClass:"table-action",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Archive"},on:{click:function(t){return t.preventDefault(),e.onActive(a)}}},[n("i",{staticClass:"fas fa-undo-alt"})])]),n("el-tooltip",{attrs:{content:"Delete",placement:"top"}},[n("a",{staticClass:"table-action table-action-delete",attrs:{href:"#!","data-toggle":"tooltip","data-original-title":"Delete"},on:{click:function(t){return t.preventDefault(),e.onDeleteArchive(a)}}},[n("i",{staticClass:"fas fa-trash"})])])],1)}}],null,!1,3319439054)})],1),e.archive.length>0?n("div",{staticClass:"card-footer py-4 d-flex justify-content-end"},[n("base-pagination",{attrs:{total:50},model:{value:e.currentPage2,callback:function(t){e.currentPage2=t},expression:"currentPage2"}})],1):e._e()],1):e._e(),e.showCreate?n("create-student",{attrs:{title:"Edit Student",name:e.fullName,isEdit:!0},on:{close:function(t){e.showCreate=!1},update:function(t){e.showCreate=!1}}}):e._e(),n("modal",{attrs:{show:e.showDelete},on:{"update:show":function(t){e.showDelete=t}}},[n("template",{slot:"header"},[n("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[e._v(" Delete Student ")])]),n("div",{staticClass:"tk-popup-content"},[e._v(" Do you want to delete the student "),e.index>=0?n("strong",{staticClass:"tk-font-color-black1"},[e._v("["+e._s(e.users[e.index].name)+"]")]):e._e(),e._v(" ? ")]),n("template",{slot:"footer"},[n("base-button",{staticClass:"tk-font-color-lightGray tk-border-none",attrs:{type:"secondary"},on:{click:function(t){t.preventDefault(),e.showDelete=!1}}},[e._v("Close")]),n("base-button",{staticClass:"tk-font-color-white tk-bg-color-red tk-border-none",attrs:{type:"primary"},on:{click:function(t){return t.preventDefault(),e.confirmDelete(t)}}},[e._v("Delete")])],1)],2)],1)},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-header border-0"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-6"},[n("h3",{staticClass:"mb-0"},[e._v("Student List")])])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-header border-0"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-6"},[n("h3",{staticClass:"mb-0"},[e._v("Archive Students")])])])])}],o=(n("9010"),n("82a8"),n("2cb5")),i=(n("cc43"),n("2984"),n("855f")),l=n.n(i),c=(n("567e"),n("2b3e")),u=n.n(c),d=(n("93fd"),n("60cf")),m=n.n(d),f=(n("ca6c"),n("2c83")),h=n.n(f),p=(n("31d0"),n("60bf")),g=n.n(p),v=(n("4f55"),n("c944")),b=n.n(v),w=[{id:2,name:"Alexandra Smith",image:"img/theme/team-2.jpg",createdAt:"08/09/2018",lesson:"Piano",lessonType:"Standard Listening",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:3,name:"Samantha Ivy",image:"/img/theme/team-3.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:4,name:"Samantha Ivy",image:"/img/theme/team-4.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:5,name:"Alexandra Smith",image:"img/theme/team-2.jpg",createdAt:"08/09/2018",lesson:"Piano",lessonType:"Standard Listening",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:6,name:"Samantha Ivy",image:"/img/theme/team-3.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1},{id:7,name:"Samantha Ivy",image:"/img/theme/team-4.jpg",createdAt:"8/08/2018",lesson:"Piano",lessonType:"Trial lesson",teacherName:"Wayne Wang",teacherImg:"/img/theme/team-4.jpg",active:!1}],y=[],x=n("a6a9"),k={name:"inline-actions-table",components:(a={},Object(o["a"])(a,b.a.name,b.a),Object(o["a"])(a,g.a.name,g.a),Object(o["a"])(a,h.a.name,h.a),Object(o["a"])(a,m.a.name,m.a),Object(o["a"])(a,u.a.name,u.a),Object(o["a"])(a,l.a.name,l.a),Object(o["a"])(a,"CreateStudent",x["default"]),a),data:function(){return{users:w,archive:y,currentPage:1,currentPage2:1,showDelete:!1,showEditTeacher:!1,isInvalid:!1,deleteArchive:!1,showCreate:!1,fullName:"",phone:"",email:"",index:-1}},methods:{onEdit:function(e){var t=this;t.fullName=e.name,t.phone=e.phone,t.email=e.email,t.showCreate=!0},onDelete:function(e){var t=this;t.users.some((function(n,a){n.id===e.id&&(t.index=a,t.showDelete=!0)}))},onDeleteArchive:function(e){var t=this;t.archive.some((function(n,a){n.id===e.id&&(t.index=a,t.showDelete=!0,t.deleteArchive=!0)}))},confirmDelete:function(){var e=this;e.showDelete=!1,e.deleteArchive?(e.archive.splice(e.index,1),e.deleteArchive=!1):e.users.splice(e.index,1),e.index=-1},onArchive:function(e){var t=this;t.users.some((function(n,a){n.id===e.id&&(t.archive.push(n),t.users.splice(a,1))}))},onActive:function(e){var t=this;t.archive.some((function(n,a){n.id===e.id&&(t.users.push(n),t.archive.splice(a,1))}))},validationEmail:function(){var e=this;e.$tools.isNull(e.email)?e.isInvalid=!1:e.isInvalid=!e.$tools.isEmail(e.email)}}},C=k,_=n("5d22"),T=Object(_["a"])(C,r,s,!1,null,null,null);t["default"]=T.exports},f923:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("6b07"),n("cf2b"),n("08b3"),n("2a39"),n("f39f"),n("4021");function a(e){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}}}]);
//# sourceMappingURL=chunk-52250cf6.8a97bd50.js.map